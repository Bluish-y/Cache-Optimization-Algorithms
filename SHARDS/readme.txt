This is the SHARDS implementation
